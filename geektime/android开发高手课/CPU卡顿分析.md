* 查看应用进程CPU使用时间

  可以通过/proc/stat得到整个系统的 CPU 使用情况，通过/proc/[pid]/stat可以得到某个进程的 CPU 使用情况

  ```shell
  HWCLT:/ $ cat /proc/26073/stat
  26073 (com.tencent.mm) S 602 752 0 0 -1 1077952832 3402711 45574 20010 27 39670 11001 33 41 10 -10 154 0 109104161 9574256640 50681 18446744073709551615 1 1 0 0 0 0 4612 4097 1073775864 0 0 0 17 0 0 0 403 0 0 0 0 0 0 0 0 0 0
  ```

  可以通过man 5 proc查看命令文档，如果提示`No manual entry for proc in section 5`需要手动安装一下命令手册,`yum install man-pages`,然后找到/proc/[pid]/stat 节点，就可以看到各字段的意思了。

  下面一个把上面输出的内容里的字段对照文档都解释一下：

  pid=26073 是进程pid

  com=(com.tencent.mm) 应用程序，这里使用的是微信

  state=S 表示任务的状态，R表示运行中,S表示睡眠，这时是可以通过给他发送信信号唤醒的，D也表示睡眠，但是这种状态不接受任何外来的信号，此时如果用kill、kill -9是杀不死的，因为压根儿不接收信号，一般处于这种状态是因为进程在等待IO,比如磁盘IO、网络IO等

  ppid=602 父进程ID

  pgid=752 线程组号

  ....此处省略一些，直接到重要的几个属性上

  utime==39670 该任务在用户态运行的时间，单位为 jiffies,反映的是用户代码执行的时间

  stime=11001 该任务在核心态运行的时间，单位为 jiffies，反映的是系统调用执行的时间

  cutime=33 累计的该任务的所有的 waited-for 进程曾经在用户态运行的时间，单位为 jiffies。

  cstime=41 累计的该任务的所有的 waited-for 进程曾经在核心态运行的时间，单位为 jiffies

  majflt=20010. 该任务需要从硬盘拷数据而发生的缺页的次数

  minflt=3402711,该任务不需要从硬盘拷数据而发生的缺页的次数

如果CPU使用长期高于60%，表示系统处于繁忙状态，就需要进一步分析用户时间和系统时间的比例，对于普通点的应用，系统时间不会从长期高于30%，如果超过，就需要检查是否有过多的IO了。

* top命令

top可以帮助查看各个进程消耗CPU的情况

* vmstat命令

可以实时动态监视操作系统的虚拟内存和CPU活动

**-V：**显示vmstat版本信息。
 **-n：**只在开始时显示一次各字段名称。
 **-a：**显示活跃和非活跃内存
 **-d：**显示磁盘相关统计信息。
 **-p：**显示指定磁盘分区统计信息
 **-s：**显示内存相关统计信息及多种系统活动数量。
 **-m：**显示slabinfo
 **-S：**使用指定单位显示。参数有 k 、K 、m 、M ，分别代表1000、1024、1000000、1048576字节（byte）。默认单位为K（1024 bytes）
 **-f：**显示从系统启动至今的fork数量 。

**delay：**刷新时间间隔。
 **count：**刷新次数。如果不指定刷新次数，但指定了刷新时间间隔，这时刷新次数为无穷

#### Procs（进程）

**r:** 等待运行的进程数
 **b:** 处在非中断睡眠状态的进程数

#### Memory（内存） 单位：KB

**swpd:** 虚拟内存使用大小
 **free:** 空闲的内存
 **buff:** 用作缓冲的内存大小
 **cache:** 用作缓存的内存大小

#### Swap  （单位：KB）

**si:** 从交换区写到内存的大小
 **so:** 每秒写入交换区的内存大小

#### IO  （单位：块/秒）

**bi:** 每秒读取的块数
 **bo:** 每秒写入的块数

#### System （系统）

**in:** 每秒中断数，包括时钟中断。
 **cs:** 每秒上下文切换数。

#### CPU（以百分比表示）：

**us:** 用户进程执行时间(user time)
 **sy:** 系统进程执行时间(system time)
 **id:** 空闲时间(包括IO等待时间),中央处理器的空闲时间 。以百分比表示。
 **wa:** 等待IO时间

* strace命令

可以跟踪某个进程中所有的系统调用

* CPU饱和度

CPU饱和度也就是CPU的负载情况，反映了线程排队等待CPU的情况，

1、如果线程数过多，容易导致系统不断的切换执行的线程，把大量的时间浪费在上下文切换，每一次上下文切换都会刷新寄存器和计数器，vmstat命令可以查看每秒线程切换次数

2、另外一个会影响 CPU 饱和度的是线程优先级，线程优先级会影响 Android 系统的调度策略，它主要由 nice 和 cgroup 类型共同决定。nice 值越低，抢占 CPU 时间片的能力越强。当 CPU 空闲时，线程的优先级对执行效率的影响并不会特别明显，但在 CPU 繁忙的时候，线程调度会对执行效率有非常大的影响

。需要注意是否存在高优先级的线程空等低优先级线程，例如主线程等待某个后台线程的锁。从应用程序的角度来看，无论是用户时间、系统时间，还是等待 CPU 的调度，都是程序运行花费的时间



   