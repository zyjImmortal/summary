* 为什么使用缓存

对于不常修改但是经常查询的数据进行缓存，能显著提高查询速率，

* 缓存级别

一级本地缓存，二级Redis，三级redis，三级的有效期不同，三级的最长，最终目标就是减少数据库的访问

编译原理，操作系统结构



* 保存什么类型的数据，以什么形式保存

从一个数值的角度，用户状态，状态码等

从数据库的角度：整个实体作为缓存对象

从查询结果角度： 针对复杂sql但是经常使用，而且不怎么变化，可以对sql取hash值，将结果缓存

从视图返回结果角度：将视图的响应结果缓存，key为请求路径，请求参数都一样

不以视图作为缓存的依据，以数据那些数据可能被多处地方都用到，可以把数据的每条记录进行缓存

 

* 存储类型:

  字符串 有点事节省空间，缺点是序列化时有时间开销，更新不方便一般直接删除

  其他复合结构(zset list hash): 读写时不需要序列化，可以更新数据，但是内存开销大

  
  
  缓存有效期的作用：节省空间、保持数据的弱一致性
  
  过期策略： 
  
  * 定时过期： 为每个可以维护一个定时器，太耗费资源，redis不用，用的下面两个
  * 惰性过期： 只有当访问这个可以的时候，采取判断是否过期，过期则删除，堆内存会造成浪费
  * 定期过期：每隔一定时间，会扫描一遍有那些数据过期，对内存和CPU是最友好的
  
   Redis每100ms随机检测一部分数据是否过期，惰性过期和定期过期策略
  
* 淘汰策略

  redis内存淘汰策略

  对设置了有效期的数据

  LRU:最近最少使用有原则
  
  LFU： 最少使用次数原则,redis会对操作过的数据计数，LFU的实际效果会好一点，但是有个问题如果某一数据达到一个很大的量级，但是在接下来不会再使用，对于一些小量级的数据反而会被删除掉，所以Redis增加了定期衰减策略，就是过段时间所有数据减半，尽量是所有数据处在同一个量级，，导致性能会差一点。



* Redis使用模式

 通读 read through

